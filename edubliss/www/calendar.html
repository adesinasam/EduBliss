<!DOCTYPE html>
<html>
<head>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fullcalendar/core@4.4.2/main.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fullcalendar/daygrid@4.4.2/main.min.css">
    <script src="https://cdn.jsdelivr.net/npm/@fullcalendar/core@4.4.2/main.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@fullcalendar/daygrid@4.4.2/main.min.js"></script>
</head>
<body>

<div id="calendar" style="width: 100%; height: 600px; border: 1px solid #000;"></div>

<script>
document.addEventListener('DOMContentLoaded', function() {
    var calendarEl = document.getElementById('calendar');
    var calendar = new FullCalendar.Calendar(calendarEl, {
        plugins: [ 'dayGrid' ],
        events: function(fetchInfo, successCallback, failureCallback) {
            var programName = 'Explorer';
            var studentGroups = [{ label: 'EXP - Premium' }];  // Ensure this is an array of objects

            fetch(`/api/method/edubliss.api.get_course_schedule_for_student?program_name=${encodeURIComponent(programName)}&student_groups=${encodeURIComponent(JSON.stringify(studentGroups))}`)
                .then(response => response.json())
                .then(data => {
                    if (data.message) {
                        const events = data.message.map(event => ({
                            title: event.title,
                            start: `${event.schedule_date}T${event.from_time}`,
                            end: `${event.schedule_date}T${event.to_time}`,
                            description: event.course,
                            color: event.class_schedule_color // Optional: colorize events based on this field
                        }));
                        successCallback(events);
                    } else {
                        console.error('No data returned:', data);
                        failureCallback('No data returned');
                    }
                })
                .catch(error => {
                    console.error('Error fetching events:', error);
                    failureCallback(error);
                });
        }
    });
    calendar.render();
});
</script>
<script>
    document.addEventListener('DOMContentLoaded', function() {
        var calendarEl = document.getElementById('calendar');
        var calendar = new FullCalendar.Calendar(calendarEl, {
            plugins: [ 'dayGrid' ],
            events: [
                {
                    title: 'Test Event',
                    start: '2024-08-01',
                    end: '2024-08-02'
                }
            ]
        });
        calendar.render();
    });
</script>

</body>
</html>
